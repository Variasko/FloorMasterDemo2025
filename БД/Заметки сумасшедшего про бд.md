1. Бд ахуеть какая большая, но нужно будет посидеть подумать над ней
2. Некоторые реализации(например написанный триггер) не будут включены в финальную работу, здесь я просто делал всё по тз, потом, я надеюсь, много чего сократится
3. Импорт с такой бдхой это просто атас ебаный
4. Сформирован скрипт вместе с импортом, так что посмотрите и разберитесь откуда что взято
5. В таблице продуктов почти все поля нулевые ТОЛЬКО ПОТОМУ ЧТО ИХ НЕТ В ИМПОРТЕ
6. Скрипт сформирован сразу после внесения импорта, так что никаких данных сверх надобности не внесено, учитывайте это при переходе ко 2 модулю
7. Далее будет описание скрипта от чата гпт
---

Этот скрипт создает базу данных **FloorMaster** для управления производством, складом, продажами и персоналом компании, специализирующейся на напольных покрытиях. Вот подробное описание:

---

### **Основные таблицы и их назначение**

#### 1. **Компании и контакты**
- **`Company`**:  
  Хранит данные о компаниях (включая партнеров и производителей):  
  - `Name` — название компании;  
  - `DirectorSurname`, `DirectorName`, `DirectorPatronymic` — ФИО директора;  
  - `INN` — ИНН;  
  - `BusinessAddress` — юридический адрес;  
  - `Logo` — логотип в бинарном виде.

- **`ContactInfo`**:  
  Содержит контактные данные (телефоны, email).  
  - `ContactInfoTypeId` — ссылка на тип контакта (телефон/email);  
  - `ContactInfo` — значение контакта.

- **`ContactInfoType`**:  
  Определяет типы контактов:  
  - `Name` — например, "Телефон", "Электронная почта".

- **`ContactInfoInCompany`**:  
  Связывает компании с их контактами (многие-ко-многим).

---

#### 2. **Сотрудники и роли**
- **`Employee`**:  
  Учет сотрудников:  
  - ФИО, дата рождения, паспортные данные;  
  - `BankAccountNumber` — номер счета для зарплаты;  
  - `HealthStatusId` — ссылка на состояние здоровья;  
  - `RoleId` — роль (например, "Администратор", "Менеджер").

- **`Role`**:  
  Список ролей сотрудников.

- **`Staff`**:  
  Связывает сотрудников с их правами доступа (`AllowanceId`).

- **`Allowance`**:  
  Уровни допуска (например, "Работа со станками", "Упаковка").

---

#### 3. **Продукция и материалы**
- **`Product`**:  
  Описание товаров:  
  - `Name` — название продукта;  
  - `Article` — артикул;  
  - `ProductTypeId` — тип (паркет, ламинат и т.д.);  
  - `MinCost` — минимальная стоимость;  
  - `PackId` — упаковка;  
  - `NetWeight`, `GrossWeight` — вес нетто и брутто.

- **`ProductType`**:  
  Типы продукции с коэффициентами (например, "Паркетная доска" — коэффициент 4.34).

- **`Material`**:  
  Материалы для производства:  
  - `ProducerId` — производитель;  
  - `AmountInPack` — количество в упаковке;  
  - `Cost` — стоимость.

- **`MaterialInProduct`**:  
  Связывает материалы с продуктами (сколько материала используется в каждом продукте).

---

#### 4. **Производители и партнеры**
- **`Producer`**:  
  Данные производителей материалов:  
  - `Name` — название;  
  - `INN` — ИНН;  
  - `ProducerTypeId` — тип (например, "Завод", "Поставщик").

- **`Partner`**:  
  Партнеры компании:  
  - `CompanyId` — ссылка на компанию;  
  - `PartnerTypeId` — тип партнера (ЗАО, ООО);  
  - `Rating` — рейтинг (по умолчанию 10.00).

- **`PartnerType`**:  
  Типы партнеров (ЗАО, ООО, ПАО, ОАО).

---

#### 5. **Продажи и склад**
- **`Sale`**:  
  История продаж:  
  - `ProductId`, `PartnerId` — проданный товар и партнер;  
  - `Amount` — сумма продажи;  
  - `SaleDate` — дата.

- **`Stoc`**:  
  Склады:  
  - `Name` — название склада;  
  - `Location` — адрес.

- **`StocHistory`**:  
  История операций на складе:  
  - `MaterialId` — материал;  
  - `OperationTypeId` — тип операции (приход/расход);  
  - `Date` — дата.

---

#### 6. **Дополнительные таблицы**
- **`Pack`**:  
  Характеристики упаковки (габариты, вес).

- **`Unit`**:  
  Единицы измерения (кг, шт, м²).

- **`Workshop`**:  
  Цеха производства:  
  - `Name` — название цеха;  
  - `EmployeeCount` — количество сотрудников.

---

### **Ключевые особенности**
1. **Связи между таблицами**:  
   - Внешние ключи (`FOREIGN KEY`) обеспечивают целостность данных.  
   Например:  
   ```sql
   ALTER TABLE [Product] ADD CONSTRAINT [FK_Product_Pack] FOREIGN KEY ([PackId]) REFERENCES [Pack]([Id]);
   ```

2. **Автоматические поля**:  
   - `IDENTITY(1,1)` для автоинкремента первичных ключей.  
   - Значение по умолчанию для рейтинга партнера:  
     ```sql
     ALTER TABLE [Partner] ADD DEFAULT (10.00) FOR [Rating];
     ```

3. **Расширенные свойства**:  
   - Комментарии через `MS_Description` (например, описание столбца `AllowanceId` в таблице `Staff`).

---

### **Пример данных**
- Вставлены тестовые данные для таблиц:  
  - **`Company`**: 5 компаний ("База Строитель", "Паркет 29" и др.).  
  - **`Product`**: 5 видов продукции (паркет, ламинат, пробковое покрытие).  
  - **`Sale`**: 16 записей о продажах с 2022 по 2024 год.

---

### **Рекомендации**
1. **Индексы**:  
   Добавьте индексы для часто используемых полей (например, `Product.Article`, `Sale.SaleDate`).

2. **Триггеры**:  
   Для автоматического расчета `GrossWeight` в `Product` на основе `Pack.Weight` и `NetWeight`.

3. **Оптимизация**:  
   Для больших данных в полях `varbinary(max)` (например, `Photo`) используйте FILESTREAM.

4. **Валидация**:  
   Добавьте проверки:  
   - `Product.MinCost > 0`;  
   - `Sale.Amount >= 0`.

---

Скрипт охватывает все основные бизнес-процессы компании, от производства до продаж, и готов к использованию после настройки индексов и оптимизации.